<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Analytics - BizPulse ERP</title>
    
    <!-- Chart.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.js"></script>
    
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --wine-primary: #732C3F;
            --wine-light: #B85450;
            --wine-lighter: #E8B4B8;
            --wine-lightest: #F5E6E8;
            --wine-dark: #5D252A;
            --gray-50: #fafafa;
            --gray-100: #f5f5f5;
            --gray-200: #e5e5e5;
            --gray-300: #d4d4d4;
            --gray-400: #a3a3a3;
            --gray-500: #737373;
            --gray-600: #525252;
            --gray-700: #404040;
            --gray-800: #262626;
            --gray-900: #171717;
            --white: #ffffff;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--white);
            color: var(--gray-900);
            line-height: 1.5;
            font-weight: 400;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .dashboard-container {
            max-width: 1440px;
            margin: 0 auto;
            padding: 32px;
            min-height: 100vh;
        }
        
        /* Header */
        .header {
            margin-bottom: 40px;
        }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .page-title {
            font-size: 32px;
            font-weight: 600;
            color: var(--gray-900);
            letter-spacing: -0.025em;
        }
        
        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: 8px;
            color: var(--gray-600);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .back-button:hover {
            background: var(--gray-50);
            border-color: var(--gray-300);
            color: var(--gray-900);
        }
        
        .page-subtitle {
            font-size: 16px;
            color: var(--gray-600);
            font-weight: 400;
        }
        
        /* Main Grid */
        .main-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 32px;
            margin-bottom: 32px;
        }
        
        /* Card Base */
        .card {
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: 16px;
            box-shadow: var(--shadow-sm);
            transition: all 0.2s ease;
        }
        
        .card:hover {
            box-shadow: var(--shadow-md);
            border-color: var(--gray-300);
        }
        
        .card-header {
            padding: 24px 24px 0 24px;
            margin-bottom: 24px;
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 4px;
            letter-spacing: -0.025em;
        }
        
        .card-subtitle {
            font-size: 14px;
            color: var(--gray-500);
            font-weight: 400;
        }
        
        .card-content {
            padding: 0 24px 24px 24px;
        }
        
        /* Main Sales Chart */
        .main-chart-card {
            position: relative;
        }
        
        .chart-controls {
            position: absolute;
            top: 24px;
            right: 24px;
            display: flex;
            background: var(--gray-50);
            border: 1px solid var(--gray-200);
            border-radius: 8px;
            padding: 2px;
        }
        
        .period-btn {
            padding: 6px 12px;
            border: none;
            background: transparent;
            color: var(--gray-600);
            font-size: 13px;
            font-weight: 500;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .period-btn.active {
            background: var(--white);
            color: var(--wine-primary);
            box-shadow: var(--shadow-sm);
        }
        
        .period-btn:hover:not(.active) {
            color: var(--gray-900);
        }
        
        .main-chart-container {
            height: 400px;
            position: relative;
        }
        
        /* Revenue Breakdown */
        .revenue-breakdown {
            text-align: center;
        }
        
        .donut-container {
            height: 280px;
            position: relative;
            margin-bottom: 24px;
        }
        
        .donut-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }
        
        .donut-total {
            font-size: 24px;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 4px;
        }
        
        .donut-label {
            font-size: 12px;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 500;
        }
        
        .revenue-legend {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 0;
        }
        
        .legend-left {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-color {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }
        
        .legend-name {
            font-size: 14px;
            color: var(--gray-700);
            font-weight: 500;
        }
        
        .legend-value {
            font-size: 14px;
            color: var(--gray-900);
            font-weight: 600;
        }
        
        /* Secondary Grid */
        .secondary-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
        }
        
        /* Top Selling Items */
        .items-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .item-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid var(--gray-100);
        }
        
        .item-row:last-child {
            border-bottom: none;
        }
        
        .item-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .item-rank {
            width: 24px;
            height: 24px;
            background: var(--wine-lightest);
            color: var(--wine-primary);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
        }
        
        .item-name {
            font-size: 14px;
            color: var(--gray-900);
            font-weight: 500;
        }
        
        .item-sales {
            font-size: 14px;
            color: var(--gray-900);
            font-weight: 600;
        }
        
        /* Profit vs Expense Chart */
        .profit-chart-container {
            height: 280px;
            position: relative;
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr;
                gap: 24px;
            }
            
            .secondary-grid {
                grid-template-columns: 1fr;
                gap: 24px;
            }
        }
        
        @media (max-width: 768px) {
            .dashboard-container {
                padding: 20px;
            }
            
            .page-title {
                font-size: 24px;
            }
            
            .header-top {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }
            
            .main-chart-container {
                height: 300px;
            }
            
            .chart-controls {
                position: static;
                margin-bottom: 16px;
            }
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--gray-100);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--gray-300);
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--gray-400);
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <div class="header">
            <div class="header-top">
                <h1 class="page-title">Sales Analytics</h1>
                <a href="/retail/dashboard" class="back-button">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="m15 18-6-6 6-6"/>
                    </svg>
                    Back to Dashboard
                </a>
            </div>
            <p class="page-subtitle">Comprehensive sales performance and revenue insights</p>
        </div>
        
        <!-- Main Grid -->
        <div class="main-grid">
            <!-- Total Sales Trend -->
            <div class="card main-chart-card">
                <div class="chart-controls">
                    <button class="period-btn active" data-period="daily">Daily</button>
                    <button class="period-btn" data-period="weekly">Weekly</button>
                    <button class="period-btn" data-period="monthly">Monthly</button>
                </div>
                <div class="card-header">
                    <h2 class="card-title">Total Sales Trend</h2>
                    <p class="card-subtitle">Revenue performance over time</p>
                </div>
                <div class="card-content">
                    <div class="main-chart-container">
                        <canvas id="salesTrendChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Revenue Breakdown -->
            <div class="card revenue-breakdown">
                <div class="card-header">
                    <h2 class="card-title">Revenue Breakdown</h2>
                    <p class="card-subtitle">Payment method distribution</p>
                </div>
                <div class="card-content">
                    <div class="donut-container">
                        <canvas id="revenueDonutChart"></canvas>
                        <div class="donut-center">
                            <div class="donut-total">₹2,45,680</div>
                            <div class="donut-label">Total Revenue</div>
                        </div>
                    </div>
                    <div class="revenue-legend" id="revenueLegend">
                        <!-- Legend items will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Secondary Grid -->
        <div class="secondary-grid">
            <!-- Top Selling Items -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Top Selling Items</h2>
                    <p class="card-subtitle">Best performing products this month</p>
                </div>
                <div class="card-content">
                    <div class="items-list" id="topItemsList">
                        <!-- Items will be populated by JavaScript -->
                    </div>
                </div>
            </div>
            
            <!-- Profit vs Expense -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Profit vs Expense</h2>
                    <p class="card-subtitle">Financial performance comparison</p>
                </div>
                <div class="card-content">
                    <div class="profit-chart-container">
                        <canvas id="profitExpenseChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Chart.js Configuration
        Chart.defaults.font.family = "'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif";
        Chart.defaults.font.size = 12;
        Chart.defaults.color = '#525252';
        
        let salesTrendChart, revenueDonutChart, profitExpenseChart;
        let currentPeriod = 'daily';
        
        // Sample Data
        const sampleData = {
            daily: {
                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                sales: [12500, 18900, 15600, 22300, 19800, 28500, 24100],
                orders: [45, 67, 52, 78, 69, 95, 84]
            },
            weekly: {
                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                sales: [85600, 92300, 78900, 105400],
                orders: [298, 341, 276, 389]
            },
            monthly: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                sales: [245600, 289300, 312800, 298500, 334200, 356700],
                orders: [1245, 1389, 1456, 1398, 1567, 1634]
            }
        };
        
        const revenueData = {
            labels: ['Cash', 'UPI', 'Card', 'Online'],
            data: [65400, 89200, 56800, 34280],
            colors: ['#732C3F', '#B85450', '#E8B4B8', '#F5E6E8']
        };
        
        const topItems = [
            { name: 'Premium Rice (5kg)', sales: 45600, rank: 1 },
            { name: 'Organic Wheat Flour', sales: 38900, rank: 2 },
            { name: 'Cold Pressed Oil', sales: 32400, rank: 3 },
            { name: 'Basmati Rice (1kg)', sales: 28700, rank: 4 },
            { name: 'Whole Grain Bread', sales: 24500, rank: 5 }
        ];
        
        const profitExpenseData = {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
            profit: [89500, 95600, 102300, 98700, 108900, 115200],
            expense: [156100, 193700, 210500, 199800, 225300, 241500]
        };
        
        // Initialize Dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
            populateTopItems();
            setupPeriodToggle();
        });
        
        function initializeCharts() {
            createSalesTrendChart();
            createRevenueDonutChart();
            createProfitExpenseChart();
        }
        
        function createSalesTrendChart() {
            const ctx = document.getElementById('salesTrendChart');
            const data = sampleData[currentPeriod];
            
            salesTrendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'Sales',
                        data: data.sales,
                        borderColor: '#732C3F',
                        backgroundColor: 'rgba(115, 44, 63, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#732C3F',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 3,
                        pointRadius: 6,
                        pointHoverRadius: 8,
                        pointHoverBackgroundColor: '#732C3F',
                        pointHoverBorderColor: '#ffffff',
                        pointHoverBorderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.95)',
                            titleColor: '#171717',
                            bodyColor: '#404040',
                            borderColor: '#e5e5e5',
                            borderWidth: 1,
                            cornerRadius: 8,
                            padding: 12,
                            displayColors: false,
                            callbacks: {
                                title: function(context) {
                                    return context[0].label;
                                },
                                label: function(context) {
                                    const orders = data.orders[context.dataIndex];
                                    return [
                                        `Sales: ₹${context.parsed.y.toLocaleString()}`,
                                        `Orders: ${orders}`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            border: {
                                display: false
                            },
                            ticks: {
                                color: '#737373',
                                font: {
                                    size: 12,
                                    weight: 500
                                }
                            }
                        },
                        y: {
                            grid: {
                                color: '#f5f5f5',
                                drawBorder: false
                            },
                            border: {
                                display: false
                            },
                            ticks: {
                                color: '#737373',
                                font: {
                                    size: 12,
                                    weight: 500
                                },
                                callback: function(value) {
                                    return '₹' + (value / 1000) + 'k';
                                }
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    animation: {
                        duration: 800,
                        easing: 'easeInOutQuart'
                    }
                }
            });
        }
        
        function createRevenueDonutChart() {
            const ctx = document.getElementById('revenueDonutChart');
            
            revenueDonutChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: revenueData.labels,
                    datasets: [{
                        data: revenueData.data,
                        backgroundColor: revenueData.colors,
                        borderWidth: 0,
                        hoverBorderWidth: 0,
                        cutout: '75%'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.95)',
                            titleColor: '#171717',
                            bodyColor: '#404040',
                            borderColor: '#e5e5e5',
                            borderWidth: 1,
                            cornerRadius: 8,
                            padding: 12,
                            displayColors: false,
                            callbacks: {
                                label: function(context) {
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((context.parsed / total) * 100).toFixed(1);
                                    return `${context.label}: ₹${context.parsed.toLocaleString()} (${percentage}%)`;
                                }
                            }
                        }
                    },
                    animation: {
                        duration: 1000,
                        easing: 'easeInOutQuart'
                    }
                }
            });
            
            // Populate legend
            populateRevenueLegend();
        }
        
        function createProfitExpenseChart() {
            const ctx = document.getElementById('profitExpenseChart');
            
            profitExpenseChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: profitExpenseData.labels,
                    datasets: [{
                        label: 'Profit',
                        data: profitExpenseData.profit,
                        borderColor: '#732C3F',
                        backgroundColor: 'rgba(115, 44, 63, 0.1)',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.4,
                        pointBackgroundColor: '#732C3F',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 4
                    }, {
                        label: 'Expense',
                        data: profitExpenseData.expense,
                        borderColor: '#a3a3a3',
                        backgroundColor: 'rgba(163, 163, 163, 0.1)',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.4,
                        pointBackgroundColor: '#a3a3a3',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 20,
                                font: {
                                    size: 12,
                                    weight: 500
                                },
                                color: '#525252'
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.95)',
                            titleColor: '#171717',
                            bodyColor: '#404040',
                            borderColor: '#e5e5e5',
                            borderWidth: 1,
                            cornerRadius: 8,
                            padding: 12,
                            displayColors: true,
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ₹${context.parsed.y.toLocaleString()}`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            border: {
                                display: false
                            },
                            ticks: {
                                color: '#737373',
                                font: {
                                    size: 11,
                                    weight: 500
                                }
                            }
                        },
                        y: {
                            grid: {
                                color: '#f5f5f5',
                                drawBorder: false
                            },
                            border: {
                                display: false
                            },
                            ticks: {
                                color: '#737373',
                                font: {
                                    size: 11,
                                    weight: 500
                                },
                                callback: function(value) {
                                    return '₹' + (value / 1000) + 'k';
                                }
                            }
                        }
                    },
                    animation: {
                        duration: 800,
                        easing: 'easeInOutQuart'
                    }
                }
            });
        }
        
        function populateRevenueLegend() {
            const legendContainer = document.getElementById('revenueLegend');
            const total = revenueData.data.reduce((a, b) => a + b, 0);
            
            legendContainer.innerHTML = revenueData.labels.map((label, index) => {
                const value = revenueData.data[index];
                const percentage = ((value / total) * 100).toFixed(1);
                
                return `
                    <div class="legend-item">
                        <div class="legend-left">
                            <div class="legend-color" style="background-color: ${revenueData.colors[index]}"></div>
                            <span class="legend-name">${label}</span>
                        </div>
                        <span class="legend-value">${percentage}%</span>
                    </div>
                `;
            }).join('');
        }
        
        function populateTopItems() {
            const itemsContainer = document.getElementById('topItemsList');
            
            itemsContainer.innerHTML = topItems.map(item => `
                <div class="item-row">
                    <div class="item-info">
                        <div class="item-rank">${item.rank}</div>
                        <span class="item-name">${item.name}</span>
                    </div>
                    <span class="item-sales">₹${item.sales.toLocaleString()}</span>
                </div>
            `).join('');
        }
        
        function setupPeriodToggle() {
            const periodBtns = document.querySelectorAll('.period-btn');
            
            periodBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // Update active state
                    periodBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Update current period
                    currentPeriod = this.dataset.period;
                    
                    // Update chart
                    updateSalesTrendChart();
                });
            });
        }
        
        function updateSalesTrendChart() {
            const data = sampleData[currentPeriod];
            
            salesTrendChart.data.labels = data.labels;
            salesTrendChart.data.datasets[0].data = data.sales;
            salesTrendChart.update('active');
        }
    </script>
</body>
</html>